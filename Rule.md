# AI Lovers - CEDEC 2014 AI Challenge

注意：本ルールドキュメントは試作版であり、今後大きく変更される可能性があります。

## ゲームの概要

あなたはプレイボーイ。女の子たちとデートして好感度を上げよう。
ライバルたちを出し抜いて、女の子たちのハートをキャッチせよ！

## ルールの疑似コード

自然言語よりコードを見せろ！という方に向けて、[ルールの疑似コード](#PseudoCode)を用意した。

## ゲームの目的

_女の子_ の _好感度_ によって決まる _人気点_ を、他の _プレイヤー_ より多く獲得する。

## ゲームの大まかな流れ

プレイヤーは4人、女の子は10人いる。

このゲームはターン制であり、各ターンごとに、プレイヤーたちは好きな女の子と _デート_ して好感度をためる。
デートの情報は一部が隠されているため、他のプレイヤーとの駆け引きが重要となる。

10ターンでゲームが終了し、プレイヤーたちはそれぞれの女の子の好感度に応じて人気点を獲得する。
女の子の好感度が最も高いプレイヤーはその女の子から人気点をもらえるが、好感度が最も低いプレイヤーは人気点を失ってしまう。
したがって、目当ての女の子とは積極的にデートして他プレイヤーより多くの好感度をためつつ、他の女の子の好感度にも気を使って失点を防ぐことが重要である。
人気点を最も多く獲得したプレイヤーの勝利となる。

## ゲームの開始

ゲームが開始すると、まずそれぞれの女の子に _熱狂度_ が3から6の間でランダムに設定され、プレイヤーに公開される。
熱狂度が高い女の子ほど、ゲーム終了時にもらえる（または失う）人気点が多くなる。

## ターンの流れ

ターンには _平日_ ターンと _休日_ ターンが存在する。
1ターン目は平日であり、1ターンごとに平日と休日が入れ替わる。
つまり、2ターンで一週間となる。

ターンが始まると、プレイヤーたちは一斉にデート相手を選ぶ。
平日では1ターンで5回（5日分）デートをするが、休日では1ターンに2回（2日分）デートする。
1回のデートでは1人の相手とデートをし、デートした相手の自分への好感度が1上がる。
ただし、休日は1回のデートにつき好感度が2上がる。
1ターン中のデート相手の割り振りは自由である。
例えば平日であれば、バラバラの5人と1回ずつデートしても良いし、同じ相手と5回デートしても良い。
なお、デート相手が他のプレイヤーと被っても、好感度はそれぞれ通常通り上昇する。

全プレイヤーがデート相手を選んだら、女の子たちの好感度が計算される。
そのターンが平日なら、誰が誰とデートしたか全員に公開される。
休日の場合は、どの女の子がデートを1回以上したかのみ公開される。

下の表は、平日と休日のデートの特徴をまとめたものである。

|                     | 平日 | 休日 |
| ------------------- | ---- | ---- |
| デート回数            | 5    | 2    |
| デート1回で上がる好感度 | 1    | 2    |
| デート情報の公開       | 全情報公開 | 女の子のデートの有無のみ公開 |

## ゲームの終了

10ターン目が終わると、ゲームが終了し、人気点の計算に入る。

女の子からもらえる人気点は、その女の子の好感度を他のプレイヤーと比べて決められる。
その女の子からの好感度が全プレイヤー中で最も高い場合は、熱狂度と同じ点数を獲得する。
逆に全プレイヤー中で最も低い場合は、熱狂度と同じ点数を失う。
トップや最下位のプレイヤーが複数いる場合は、熱狂度をそれらのプレイヤーの人数で割った点だけ得点あるいは失点する。

各プレイヤーの人気点を全員の女の子に対して計算したら、最も人気点の高いプレイヤーが勝利する。
人気点トップのプレイヤーが複数いる場合は、そのゲームは引き分けとなる。

## AIの入出力形式

AIはゲーム開始時に実行される。
ゲームを始める準備ができたら`READY`と出力したのち、ゲームの設定を入力として受け取る。
また、ターンごとに現在の情報を入力として受け取り、そのターンでのデート相手を出力する。

### 準備完了メッセージの出力形式

ゲームを開始する準備ができたら、`READY`と標準出力に出力する。
ゲーム開始から5秒以内に出力がなければ、制限時間超過で敗北する。

### ゲーム設定の入力形式

ゲーム開始時、つまり1ターン目の初めに、ゲームの設定が以下のフォーマットで標準入力に渡される。

<pre>
T P H
E<sub>0</sub> E<sub>1</sub> E<sub>2</sub> ... E<sub>9</sub>
</pre>

* T: 全ターン数。
* P: プレイヤー数。
* H: 女の子の数。
* E<sub>n</sub>: 女の子nの熱狂度。

### ターン情報の入力形式

各ターンの初めに、現在の情報が以下のフォーマットで標準入力に渡される。

<pre>
T D
L<sub>00</sub>　L<sub>01</sub> L<sub>02</sub> L<sub>03</sub>
L<sub>10</sub>　L<sub>11</sub> L<sub>12</sub> L<sub>13</sub>
L<sub>20</sub>　L<sub>21</sub> L<sub>22</sub> L<sub>23</sub>
:
:
L<sub>90</sub>　L<sub>91</sub> L<sub>92</sub> L<sub>93</sub>
R<sub>0</sub> R<sub>1</sub> R<sub>2</sub> ... R<sub>9</sub>
B<sub>0</sub> B<sub>1</sub> B<sub>2</sub> ... B<sub>9</sub>
</pre>

* T: 現在のターン数。1から始まる。
* D: 平日の場合は"W", 休日の場合は"H"。
* L<sub>nm</sub>: 女の子nからプレイヤーmへの公開されている（つまり平日の情報のみでわかる）好感度。このAIプレイヤー自身はプレイヤー0である。
* R<sub>n</sub>: 女の子nからこのAIプレイヤーへの真の（つまり休日も合わせた）好感度。
* B<sub>n</sub>: 女の子nが前日の休日にデートをした(1)かしていない(0)か。

B<sub>0</sub> B<sub>1</sub> B<sub>2</sub> ... B<sub>9</sub>の行は、平日のターンでのみ含まれる。

### 行動の出力形式

そのターンでのデート相手は、以下のフォーマットで標準出力に出力する。

* __平日の場合__

  <pre>
  H<sub>0</sub> H<sub>1</sub> H<sub>2</sub> H<sub>3</sub> H<sub>4</sub>
  </pre>
  
* __休日の場合__

  <pre>
  H<sub>0</sub> H<sub>1</sub>
  </pre>

H<sub>n</sub>: デート相手の女の子。順番は関係しない。

なお、ターン開始から1秒以内に出力がなければ、制限時間超過で敗北する。

<a name="PseudoCode"></a>

## ルールの疑似コード

    heroine = (enthusiasm, revealed_love[4], real_love[4])

    main:
        init
        while turn <= 10:
            process_turn
            turn += 1
        finish

    init:
        players = player[4]
        heroines = heroine[10] (rand(3, 6), [0, 0, 0, 0], [0, 0, 0, 0])
        turn = 1

    process_turn:
        for h in heroines:
            display_to_all_players(h.enthusiasm)
            display_to_all_players(h.revealed_love)
            if not is_holiday:
                display_to_all_players(h.dated)
            h.dated = false

        for p in players:
            for i in [1 .. (is_holiday ? 2 : 5)]:
                target = heroines[p.selected[i]]
                target.revealed_love[p] += (is_holiday ? 0 : 1)
                target.real_love[p] += (is_holiday ? 2 : 1)
                target.dated = true

    is_holiday:
        turn % 2 == 0

    finish:
        for h in heroines:
            best_players = players.max_by(p -> h.real_love[p])
            for p in best_players:
                p.popularity += h.enthusiasm / best_players.size

            worst_players = players.min_by(p -> h.real_love[p])
            for p in worst_players:
                p.popularity -= h.enthusiasm / worst_players.size

        winners = players.max_by(p -> p.popularity)
        draw if winners.size > 1